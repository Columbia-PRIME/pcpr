<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Retrieve default PCP parameter settings for given matrix — get_pcp_defaults • pcpr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Retrieve default PCP parameter settings for given matrix — get_pcp_defaults"><meta name="description" content='get_pcp_defaults() calculates "default" PCP parameter settings lambda,
mu (used in root_pcp()), and eta (used in rrmc()) for a given data
matrix D.
The "default" values of lambda and mu offer theoretical guarantees
of optimal estimation performance. Candès et al. (2011) obtained the
guarantee for lambda, while
Zhang et al. (2021)
obtained the result for mu. It has not yet been proven whether or
not eta enjoys similar properties.
In practice it is common to find different optimal parameter values
after tuning these parameters in a grid search. Therefore, it is
recommended to use these defaults primarily to help define a reasonable
initial parameter search space to pass into grid_search_cv().'><meta property="og:description" content='get_pcp_defaults() calculates "default" PCP parameter settings lambda,
mu (used in root_pcp()), and eta (used in rrmc()) for a given data
matrix D.
The "default" values of lambda and mu offer theoretical guarantees
of optimal estimation performance. Candès et al. (2011) obtained the
guarantee for lambda, while
Zhang et al. (2021)
obtained the result for mu. It has not yet been proven whether or
not eta enjoys similar properties.
In practice it is common to find different optimal parameter values
after tuning these parameters in a grid search. Therefore, it is
recommended to use these defaults primarily to help define a reasonable
initial parameter search space to pass into grid_search_cv().'><meta property="og:image" content="https://columbia-prime.github.io/pcpr/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pcpr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/pcp-applied.html">Air pollution source apportionment with PCP</a></li>
    <li><a class="dropdown-item" href="../articles/pcp-quickstart.html">Quickstart: applying PCP to a simulated environmental mixture</a></li>
    <li><a class="dropdown-item" href="../articles/theory-crash-course.html">Theory crash course</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Columbia-PRIME/pcpr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Retrieve default PCP parameter settings for given matrix</h1>
      <small class="dont-index">Source: <a href="https://github.com/Columbia-PRIME/pcpr/blob/main/R/get_pcp_defaults.R" class="external-link"><code>R/get_pcp_defaults.R</code></a></small>
      <div class="d-none name"><code>get_pcp_defaults.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>get_pcp_defaults()</code> calculates "default" PCP parameter settings <code>lambda</code>,
<code>mu</code> (used in <code><a href="root_pcp.html">root_pcp()</a></code>), and <code>eta</code> (used in <code><a href="rrmc.html">rrmc()</a></code>) for a given data
matrix <code>D</code>.</p>
<p>The "default" values of <code>lambda</code> and <code>mu</code> offer <em>theoretical</em> guarantees
of optimal estimation performance. Candès et al. (2011) obtained the
guarantee for <code>lambda</code>, while
<a href="https://proceedings.neurips.cc/paper/2021/hash/f65854da4622c1f1ad4ffeb361d7703c-Abstract.html" class="external-link">Zhang et al. (2021)</a>
obtained the result for <code>mu</code>. <em>It has not yet been proven whether or
not <code>eta</code> enjoys similar properties.</em></p>
<p><em>In practice</em> it is common to find different optimal parameter values
after tuning these parameters in a grid search. Therefore, <strong>it is
recommended to use these defaults primarily to help define a reasonable
initial parameter search space to pass into <code><a href="grid_search_cv.html">grid_search_cv()</a></code>.</strong></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_pcp_defaults</span><span class="op">(</span><span class="va">D</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-d">D<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>The input data matrix.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing:</p><ul><li><p><code>lambda</code>: The theoretically optimal <code>lambda</code> value used in <code><a href="root_pcp.html">root_pcp()</a></code>.</p></li>
<li><p><code>mu</code>: The theoretically optimal <code>mu</code> value used in <code><a href="root_pcp.html">root_pcp()</a></code>.</p></li>
<li><p><code>eta</code>: The default <code>eta</code> value used in <code><a href="rrmc.html">rrmc()</a></code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="the-intuition-behind-pcp-parameters">The intuition behind PCP parameters<a class="anchor" aria-label="anchor" href="#the-intuition-behind-pcp-parameters"></a></h2>


<p><code><a href="root_pcp.html">root_pcp()</a></code>'s objective function is given by:
$$\min_{L, S} ||L||_* + \lambda ||S||_1 + \mu ||L + S - D||_F$$</p><ul><li><p><code>lambda</code> controls the sparsity of <code><a href="root_pcp.html">root_pcp()</a></code>'s output <code>S</code> matrix;
larger values of <code>lambda</code> penalize non-zero entries in <code>S</code> more
stringently, driving the recovery of sparser <code>S</code> matrices. Therefore,
if you a priori expect few outlying events in your model, you might
expect a grid search to recover relatively larger <code>lambda</code> values, and
vice-versa.</p></li>
<li><p><code>mu</code> adjusts <code><a href="root_pcp.html">root_pcp()</a></code>'s sensitivity to noise; larger values of <code>mu</code>
penalize errors between the predicted model and the observed data (i.e.
noise), more severely. Environmental data subject to higher noise levels
therefore require a <code><a href="root_pcp.html">root_pcp()</a></code> model equipped with smaller <code>mu</code> values
(since higher noise means a greater discrepancy between the observed
mixture and the true underlying low-rank and sparse model). In virtually
noise-free settings (e.g. simulations), larger values of <code>mu</code> would be
appropriate.</p></li>
</ul><p><code><a href="rrmc.html">rrmc()</a></code>'s objective function is given by:
$$\min_{L, S} I_{rank(L) \leq r} + \eta ||S||_0 + ||L + S - D||_F^2$$</p><ul><li><p><code>eta</code> controls the sparsity of <code><a href="rrmc.html">rrmc()</a></code>'s output <code>S</code> matrix, just as
<code>lambda</code> does for <code><a href="root_pcp.html">root_pcp()</a></code>. Because there are no other parameters
scaling the noise term, <code>eta</code> can be thought of as a ratio between
<code><a href="root_pcp.html">root_pcp()</a></code>'s <code>lambda</code> and <code>mu</code>: Larger values of <code>eta</code> will place a
greater emphasis on penalizing the non-zero entries in <code>S</code> over penalizing
the errors between the predicted and observed data (the dense noise <code>Z</code>).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="the-calculation-of-the-default-pcp-parameters">The calculation of the "default" PCP parameters<a class="anchor" aria-label="anchor" href="#the-calculation-of-the-default-pcp-parameters"></a></h2>


<ul><li><p><code>lambda</code> is calculated as \(\lambda = 1 / \sqrt{\max(n, p)},\) where
\(n\) and \(p\) are the dimensions of the input matrix
\(D_{n \times p}\) Candès et al. (2011).</p></li>
<li><p><code>mu</code> is calculated as \(\mu = \sqrt{\frac{\min(n, p)}{2}},\) where
\(n\) and \(p\) are as above
[<a href="https://proceedings.neurips.cc/paper/2021/hash/f65854da4622c1f1ad4ffeb361d7703c-Abstract.html" class="external-link">Zhang et al. (2021)</a>].</p></li>
<li><p><code>eta</code> is simply \(\eta = \frac{\lambda}{\mu}\).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Candès, Emmanuel J., Xiaodong Li, Yi Ma, and John Wright.
"Robust principal component analysis?." Journal of the ACM (JACM)
58, no. 3 (2011): 1-37.</p>
<p>Zhang, Junhui, Jingkai Yan, and John Wright.
"Square root principal component pursuit: tuning-free noisy robust matrix
recovery." Advances in Neural Information Processing Systems 34 (2021):
29464-29475. [available
<a href="https://proceedings.neurips.cc/paper/2021/hash/f65854da4622c1f1ad4ffeb361d7703c-Abstract.html" class="external-link">here</a>]</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="grid_search_cv.html">grid_search_cv()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Examine the queens PM2.5 data</span></span></span>
<span class="r-in"><span><span class="va">queens</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2,443 × 27</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Date            Al   NH4      As     Ba       Br     Cd      Ca      Cl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> 2001-04-04 <span style="color: #BB0000;">NA</span>      1.62  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> 2001-04-07  0      2.66   0       0.012  0.004<span style="text-decoration: underline;">88</span>  0      0.040<span style="text-decoration: underline;">1</span>  0.007<span style="text-decoration: underline;">9</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> 2001-04-13  0.009<span style="text-decoration: underline;">4</span> 1.41   0.001<span style="text-decoration: underline;">6</span>  0.024  0.002<span style="text-decoration: underline;">11</span>  0.004  0.036   0     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> 2001-04-19  0.010<span style="text-decoration: underline;">4</span> 1.22   0.001   0.006  0.004<span style="text-decoration: underline;">22</span>  0      0.054<span style="text-decoration: underline;">3</span>  0.003 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> 2001-04-25  0.017<span style="text-decoration: underline;">2</span> 0.723  0.002<span style="text-decoration: underline;">4</span>  0.015  0.001<span style="text-decoration: underline;">17</span>  0      0.039<span style="text-decoration: underline;">8</span>  0     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> 2001-05-01  0.038<span style="text-decoration: underline;">4</span> 3.48   0.001<span style="text-decoration: underline;">7</span>  0.041  0.008<span style="text-decoration: underline;">73</span>  0.001  0.136   0     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> 2001-05-04  0.096<span style="text-decoration: underline;">4</span> 6.22   0.002<span style="text-decoration: underline;">5</span>  0.039  0.011<span style="text-decoration: underline;">1</span>   0      0.137   0     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> 2001-05-07  0.004  0.233  0.001   0.016  0.002<span style="text-decoration: underline;">63</span>  0      0.055   0.005<span style="text-decoration: underline;">4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> 2001-05-10  0.054<span style="text-decoration: underline;">7</span> 2.04   0.001   0.055  0.005<span style="text-decoration: underline;">21</span>  0      0.121   0.001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> 2001-05-13  0.021<span style="text-decoration: underline;">5</span> 0.229  0       0.021  0.001<span style="text-decoration: underline;">22</span>  0      0.024<span style="text-decoration: underline;">9</span>  0     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 2,433 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 18 more variables: Cr &lt;dbl&gt;, Cu &lt;dbl&gt;, EC &lt;dbl&gt;, Fe &lt;dbl&gt;, Pb &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   Mg &lt;dbl&gt;, Mn &lt;dbl&gt;, Ni &lt;dbl&gt;, OC &lt;dbl&gt;, K &lt;dbl&gt;, Se &lt;dbl&gt;, Si &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   Na &lt;dbl&gt;, S &lt;dbl&gt;, Ti &lt;dbl&gt;, NO3 &lt;dbl&gt;, V &lt;dbl&gt;, Zn &lt;dbl&gt;</span></span>
<span class="r-in"><span><span class="co"># Get rid of the Date column</span></span></span>
<span class="r-in"><span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">queens</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">queens</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Get default PCP parameters</span></span></span>
<span class="r-in"><span><span class="va">default_params</span> <span class="op">&lt;-</span> <span class="fu">get_pcp_defaults</span><span class="op">(</span><span class="va">D</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Use default parameters to define parameter search space</span></span></span>
<span class="r-in"><span><span class="va">scaling_factors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span> <span class="op">*</span> <span class="fl">10</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">etas_to_grid_search</span> <span class="op">&lt;-</span> <span class="va">default_params</span><span class="op">$</span><span class="va">eta</span> <span class="op">*</span> <span class="va">scaling_factors</span></span></span>
<span class="r-in"><span><span class="va">etas_to_grid_search</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 5.611340e-05 1.122268e-04 5.611340e-04 1.122268e-03 5.611340e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6] 1.122268e-02 5.611340e-02 1.122268e-01 5.611340e-01 1.122268e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] 5.611340e+00 1.122268e+01 5.611340e+01 1.122268e+02</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://lawrence-chillrud.github.io/" class="external-link">Lawrence G. Chillrud</a>, <a href="https://www.linkedin.com/in/jaime-benavides-72959356/" class="external-link">Jaime Benavides</a>, <a href="https://lizzy.codes/index.html" class="external-link">Elizabeth A. Gibson</a>, <a href="https://scholar.google.com/citations?user=LyLU8koAAAAJ&amp;hl=en" class="external-link">Junhui Zhang</a>, <a href="https://www.linkedin.com/in/jingkai-yan-a49a9516a/" class="external-link">Jingkai Yan</a>, <a href="https://www.columbia.edu/~jw2966/" class="external-link">John N. Wright</a>, <a href="https://jeffgoldsmith.com/" class="external-link">Jeff Goldsmith</a>, <a href="https://marianthi.github.io/makLAB.github.io/" class="external-link">Marianthi-Anna Kioumourtzoglou</a>, <a href="https://www.publichealth.columbia.edu/" class="external-link"><img src="https://www.publichealth.columbia.edu/sites/default/files/logo-mailman-blue-horizontal.svg?stefxf" width="240" alt=""></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

